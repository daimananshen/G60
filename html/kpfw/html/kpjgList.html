<!DOCTYPE html>
<html lang="en" xmlns:v-bind="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>科普机构</title>
    <link rel="stylesheet" href="../../../util/dist/mescroll.min.css">
    <link rel="stylesheet" href="../../../util/dotJump/option/mescroll-option.css">
    <link rel="stylesheet" href="../../../css/mui.min.css">

    <link rel="stylesheet" href="../css/mapScienceList.css">
    <script src="../js/flexible.js"></script>
    <script src="../../../js/mui.min.js"></script>
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../../../js/swiper.js"></script>
    <script src="../../../js/common.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/vue.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../js/API.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../util/dist/mescroll.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../util/dotJump/option/mescroll-option.js" type="text/javascript" charset="utf-8"></script>
    <style>
        .container_mapScienceList ul li a {
            box-shadow: none;
        }

        .mescroll-empty img {
            display: inline-block;
        }
    </style>
</head>

<body>
    <div id="mescroll" class="mescroll">
        <div class="mui-scroll">


            <p id="num" style="width: 100vw;text-align: center"></p>
            <div class="detailslistBox infoBoxIndex container_mapScienceList ">
                <ul id="dataList" class="mui-table-view">
                    <li v-for="item in item" v-bind:data-id="item.id" @click="openDetails(item)">
                        <a href="#" onclick="Details(item)">
                            <div class="img">
                                <img img :src="item.pic" alt="">
                            </div>
                            <div class="info">
                                <p class="title">{{item.name}}</p>
                                <p class="content" v-html="item.introduction">
                                    {{item.introduction}}
                                </p>
                            </div>
                        </a>
                    </li>

                    <!--<li>-->
                    <!--<a href="#" onclick="openDetails()">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="#">-->
                    <!--<div class="img">-->
                    <!--<img src="../images/试用图片.png" alt="">-->
                    <!--</div>-->
                    <!--<div class="info">-->
                    <!--<p class="title">上海地质科普馆</p>-->
                    <!--<p class="content">-->
                    <!--简介:上海地质科普馆又名月亮湾宝石城，坐落上海浦东国际机场后花园的浦东凌空农艺大观园内，科普馆主厅3600平方米，次厅1000多平方米，室外奇石展面积500亩。馆内分为地球厅、地球构造厅、矿物岩石厅、古生物厅、地质地貌厅、国土-->
                    <!--</p>-->
                    <!--</div>-->
                    <!--</a>-->
                    <!--</li>-->
                </ul>
            </div>
        </div>
    </div>
    <script>

    </script>
</body>
<script>

    var strItem = [];
    var show_items = []; //页面展示信息
    var num = 0;
    var page = 20;
    //创建MeScroll对象
    var mescroll = initMeScroll("mescroll", {
        down: {
            autoShowLoading: true, //如果在初始化完毕之后自动执行下拉回调,是否显示下拉刷新进度; 默认false. (需配置down的callback才生效)
            callback: function (mescroll) {
                //下拉刷新的回调,加载轮播数据
                //loadSwiper();
                num = 0;
                //重置上拉加载列表为第一页
                mescroll.resetUpScroll();
            }
        },
        up: {
            clearEmptyId: "dataList",
            isBoth: true, //上拉加载时,如果滑动到列表顶部是否可以同时触发下拉刷新;默认false,两者不可同时触发; 这里为了演示改为true,不必等列表加载完毕才可下拉;
            isBounce: false, //此处禁止ios回弹,解析(务必认真阅读,特别是最后一点): http://www.mescroll.com/qa.html#q10

            callback: getListData, //上拉加载的回调
            toTop: { //配置回到顶部按钮
                src: "http://47.101.195.208/web/util/dotJump/option/mescroll-totop.png", //默认滚动到1000px显示,可配置offset修改
                //offset : 1000
            },
            lazyLoad: {
                use: true // 是否开启懒加载,默认false
            }
        }
    });


    function updates() {
        num = 0
        mescroll.resetUpScroll();
    }
    /*联网加载列表数据  page = {num:1, size:10}; num:当前页 从1开始, size:每页数据条数 */
    function getListData() {
        num = num + 1
        //联网加载数据
        getListDataFromNet(function (curPageData) {
            //联网成功的回调,隐藏下拉刷新和上拉加载的状态;
            //mescroll会根据传的参数,自动判断列表如果无任何数据,则提示空;列表无下一页数据,则提示无更多数据;

            //方法一(推荐): 后台接口有返回列表的总页数 totalPage
            //mescroll.endByPage(curPageData.length, totalPage); //必传参数(当前页的数据个数, 总页数)

            //方法二(推荐): 后台接口有返回列表的总数据量 totalSize
            //mescroll.endBySize(curPageData.length, totalSize); //必传参数(当前页的数据个数, 总数据量)

            //方法三(推荐): 您有其他方式知道是否有下一页 hasNext
            //mescroll.endSuccess(curPageData.length, hasNext); //必传参数(当前页的数据个数, 是否有下一页true/false)

            //方法四 (不推荐),会存在一个小问题:比如列表共有20条数据,每页加载10条,共2页.如果只根据当前页的数据个数判断,则需翻到第三页才会知道无更多数据,如果传了hasNext,则翻到第二页即可显示无更多数据.
            if (curPageData.content != undefined) {
                mescroll.endSuccess(curPageData.content.length, curPageData.content.length >= page);
            }

            //设置列表数据
            setListData(curPageData.content);
        }, function () {
            //联网失败的回调,隐藏上拉加载的状态
            mescroll.endErr();
        });
    }

    /*设置列表数据*/
    function setListData(curPageData) {
        if (curPageData.length > 0) {
            for (var i = 0; i < curPageData.length; i++) {
                strItem.push(curPageData[i])
            }
        }

    }


    var vm = new Vue({
        el: "#dataList",
        data: {
            item: strItem,
            show_item: show_items,
        },
        created: function () {
            this.show_item = this.item;
        },
        methods: {
            imgError: function (item) {
                console.log(item)
                item.img = require('../../images/企业1.png');
            }
        }
    })

    /*联网加载列表数据
     在您的实际项目中,请参考官方写法: http://www.mescroll.com/api.html#tagUpCallback
     请忽略getListDataFromNet的逻辑,这里仅仅是在本地模拟分页数据,本地演示用
     实际项目以您服务器接口返回的数据为准,无需本地处理分页.
     * */
    function getListDataFromNet(successCallback, errorCallback) {
        //延时一秒,模拟联网
        setTimeout(function () {
            $.ajax({
                type: 'post',
                url: ip + 'ScienceOrganization/list',
                data: {
                    pageSize: page,
                    pageNum: num,
                    name: $("#TempName").val(),
                    type: 0,
                    City: localStorage.getItem("KepjgCity")
                },
                success: function (data) {
                    var listData = data;

                    //回调
                    successCallback(listData);
                    $("#num").html("共检索到:" + listData.content.length + "条")
                },
                error: errorCallback
            });
        }, 500)
    }

    function openDetails(item) {

        var arrUrl = location.href.split("/");
        var pageName = arrUrl[arrUrl.length - 1];
        if (!localStorage.getItem("token") && pageName != "login.html") {
            localStorage.removeItem("data-content");
            localStorage.setItem("data-content", JSON.stringify(item));
            location.href = "http://kzcloud.g60.kechuang.cn/g60-h5/html/login.html?redirect=kpfw/html/kpjgDetails.html";
        } else {
            localStorage.removeItem("data-content");
            localStorage.setItem("data-content", JSON.stringify(item));
            var webview = mui.openWindow({
                url: 'kpjgDetails.html',
                id: "kpjgDetails.html",
                extras: {
                    name: 'mui'  //扩展参数
                }
            });
        }

    }
</script>

</html>